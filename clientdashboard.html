<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Dashboard - LabourLinks Kenya</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .sidebar {
            min-height: calc(100vh - 4rem);
        }
        .active-nav-item {
            background-color: #F7941D;
            color: white;
        }
        .active-nav-item:hover {
            background-color: #e07e0c;
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-6xl mx-auto px-4">
            <div class="flex justify-between">
                <div class="flex space-x-7">
                    <div>
                        <a href="landing.html" class="flex items-center py-4 px-2">
                            <span class="font-semibold text-orange-500 text-2xl">LabourLinks</span>
                        </a>
                    </div>
                </div>
                <div class="hidden md:flex items-center space-x-1">
                    <a href="landing.html" class="py-4 px-2 text-gray-500 font-semibold hover:text-orange-500 transition duration-300">Home</a>
                    <a href="job.html" class="py-4 px-2 text-gray-500 font-semibold hover:text-orange-500 transition duration-300">Jobs</a>
                    <a href="postjob.html" class="py-4 px-2 text-gray-500 font-semibold hover:text-orange-500 transition duration-300">Post Job</a>
                    <div class="relative group">
                        <button class="py-4 px-2 text-gray-500 font-semibold hover:text-orange-500 transition duration-300 flex items-center">
                            <span>John D.</span>
                            <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10 hidden group-hover:block">
                            <a href="clientdashboard.html" class="block px-4 py-2 text-gray-800 hover:bg-orange-500 hover:text-white">Dashboard</a>
                            <a href="#" class="block px-4 py-2 text-gray-800 hover:bg-orange-500 hover:text-white">Settings</a>
                            <a href="landing.html" class="block px-4 py-2 text-gray-800 hover:bg-orange-500 hover:text-white">Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Dashboard Content -->
    <div class="flex">
        <!-- Sidebar -->
        <div class="w-64 bg-gray-800 text-white sidebar">
            <div class="p-4">
                <div class="flex items-center space-x-4 p-4 border-b border-gray-700">
                    <div class="bg-orange-500 text-white rounded-full w-12 h-12 flex items-center justify-center">
                        <i class="fas fa-building text-xl"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold">Prime Builders Kenya</h3>
                        <p class="text-xs text-gray-400">Verified Employer</p>
                    </div>
                </div>
                <nav class="mt-6">
                    <a href="clientdashboard.html" class="flex items-center px-4 py-3 active-nav-item rounded-lg">
                        <i class="fas fa-tachometer-alt mr-3"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 rounded-lg">
                        <i class="fas fa-briefcase mr-3"></i>
                        <span>My Jobs</span>
                    </a>
                    <a href="#" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 rounded-lg">
                        <i class="fas fa-users mr-3"></i>
                        <span>Applicants</span>
                    </a>
                    <a href="#" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 rounded-lg">
                        <i class="fas fa-file-invoice-dollar mr-3"></i>
                        <span>Payments</span>
                    </a>
                    <a href="#" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 rounded-lg">
                        <i class="fas fa-cog mr-3"></i>
                        <span>Settings</span>
                    </a>
                </nav>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 p-8">
            <h1 class="text-2xl font-bold text-gray-800 mb-6">Client Dashboard</h1>
            
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center">
                        <div class="bg-orange-100 p-3 rounded-full mr-4">
                            <i class="fas fa-briefcase text-orange-500"></i>
                        </div>
                        <div>
                            <h3 class="text-gray-500 text-sm">Active Jobs</h3>
                            <p class="text-2xl font-bold text-gray-800">5</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center">
                        <div class="bg-blue-100 p-3 rounded-full mr-4">
                            <i class="fas fa-users text-blue-500"></i>
                        </div>
                        <div>
                            <h3 class="text-gray-500 text-sm">Total Applicants</h3>
                            <p class="text-2xl font-bold text-gray-800">24</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center">
                        <div class="bg-green-100 p-3 rounded-full mr-4">
                            <i class="fas fa-check-circle text-green-500"></i>
                        </div>
                        <div>
                            <h3 class="text-gray-500 text-sm">Hired Workers</h3>
                            <p class="text-2xl font-bold text-gray-800">8</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Jobs -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800">Recent Job Posts</h2>
                    <a href="postjob.html" class="text-orange-500 hover:text-orange-600 font-medium">Post New Job</a>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Job Title</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Applications</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="font-medium text-gray-900">Construction Workers</div>
                                    <div class="text-sm text-gray-500">Posted: 2 days ago</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-gray-900">Nairobi, Westlands</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">12 new</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-orange-100 text-orange-800">Active</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <a href="#" class="text-orange-600 hover:text-orange-900 mr-3">View</a>
                                    <a href="#" class="text-blue-600 hover:text-blue-900">Edit</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="font-medium text-gray-900">Mason Assistant</div>
                                    <div class="text-sm text-gray-500">Posted: 1 week ago</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-gray-900">Nairobi, Kilimani</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">5 new</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-orange-100 text-orange-800">Active</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <a href="#" class="text-orange-600 hover:text-orange-900 mr-3">View</a>
                                    <a href="#" class="text-blue-600 hover:text-blue-900">Edit</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="font-medium text-gray-900">Painter Needed</div>
                                    <div class="text-sm text-gray-500">Posted: 2 weeks ago</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-gray-900">Nairobi, Karen</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">7 total</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">Filled</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <a href="#" class="text-orange-600 hover:text-orange-900 mr-3">View</a>
                                    <a href="#" class="text-blue-600 hover:text-blue-900">Repost</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Recent Applicants -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800">Recent Applicants</h2>
                    <a href="#" class="text-orange-500 hover:text-orange-600 font-medium">View All</a>
                </div>
                <div class="space-y-4">
                    <!-- Applicant 1 -->
                    <div class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50">
                        <div class="flex-shrink-0">
                            <div class="bg-gray-200 rounded-full w-12 h-12 flex items-center justify-center">
                                <i class="fas fa-user text-gray-500"></i>
                            </div>
                        </div>
                        <div class="ml-4 flex-1">
                            <h3 class="font-medium text-gray-900">James Mwangi</h3>
                            <p class="text-sm text-gray-500">Applied for Construction Workers</p>
                            <div class="mt-1 flex items-center">
                                <i class="fas fa-map-marker-alt text-xs text-gray-400 mr-1"></i>
                                <span class="text-xs text-gray-500">Nairobi, Westlands</span>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800">New</span>
                            <a href="#" class="text-orange-500 hover:text-orange-600">
                                <i class="fas fa-ellipsis-v"></i>
                            </a>
                        </div>
                    </div>

                    <!-- Applicant 2 -->
                    <div class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50">
                        <div class="flex-shrink-0">
                            <div class="bg-gray-200 rounded-full w-12 h-12 flex items-center justify-center">
                                <i class="fas fa-user text-gray-500"></i>
                            </div>
                        </div>
                        <div class="ml-4 flex-1">
                            <h3 class="font-medium text-gray-900">Peter Ochieng</h3>
                            <p class="text-sm text-gray-500">Applied for Mason Assistant</p>
                            <div class="mt-1 flex items-center">
                                <i class="fas fa-map-marker-alt text-xs text-gray-400 mr-1"></i>
                                <span class="text-xs text-gray-500">Nairobi, Kibera</span>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800">Pending</span>
                            <a href="#" class="text-orange-500 hover:text-orange-600">
                                <i class="fas fa-ellipsis-v"></i>
                            </a>
                        </div>
                    </div>

                    <!-- Applicant 3 -->
                    <div class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50">
                        <div class="flex-shrink-0">
                            <div class="bg-gray-200 rounded-full w-12 h-12 flex items-center justify-center">
                                <i class="fas fa-user text-gray-500"></i>
                            </div>
                        </div>
                        <div class="ml-4 flex-1">
                            <h3 class="font-medium text-gray-900">Susan Wambui</h3>
                            <p class="text-sm text-gray-500">Applied for Painter Needed</p>
                            <div class="mt-1 flex items-center">
                                <i class="fas fa-map-marker-alt text-xs text-gray-400 mr-1"></i>
                                <span class="text-xs text-gray-500">Nairobi, Kawangware</span>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800">Hired</span>
                            <a href="#" class="text-orange-500 hover:text-orange-600">
                                <i class="fas fa-ellipsis-v"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loadingDiv = document.getElementById('dashboard-loading');
            const recentJobsDiv = document.getElementById('recent-jobs');
            const recentApplicantsDiv = document.getElementById('recent-applicants');
            
            // Fetch dashboard data
            Promise.all([
                fetch('http://127.0.0.1:5000/api/client/stats').then(res => res.json()),
                fetch('http://127.0.0.1:5000/api/client/jobs').then(res => res.json()),
                fetch('http://127.0.0.1:5000/api/client/applicants').then(res => res.json())
            ])
            .then(([stats, jobs, applicants]) => {
                loadingDiv.style.display = 'none';
                
                // Update stats
                document.getElementById('active-jobs-count').textContent = stats.activeJobs;
                document.getElementById('total-applicants').textContent = stats.totalApplicants;
                document.getElementById('hired-workers').textContent = stats.hiredWorkers;
                
                // Populate jobs table
                const jobsTable = document.getElementById('jobs-table-body');
                jobs.forEach(job => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="font-medium text-gray-900">${job.title}</div>
                            <div class="text-sm text-gray-500">Posted: ${formatDate(job.postedDate)}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-gray-900">${job.location}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${job.newApplications > 0 ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}">
                                ${job.newApplications > 0 ? `${job.newApplications} new` : `${job.totalApplications} total`}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusClass(job.status)}">
                                ${job.status}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <a href="job-detail.html?id=${job.id}" class="text-orange-600 hover:text-orange-900 mr-3">View</a>
                            ${job.status === 'Active' ? 
                                `<a href="edit-job.html?id=${job.id}" class="text-blue-600 hover:text-blue-900">Edit</a>` : 
                                `<a href="#" class="text-blue-600 hover:text-blue-900">Repost</a>`}
                        </td>
                    `;
                    jobsTable.appendChild(row);
                });
                recentJobsDiv.style.display = 'block';
                
                // Populate applicants
                const applicantsList = document.getElementById('applicants-list');
                applicants.forEach(applicant => {
                    const applicantDiv = document.createElement('div');
                    applicantDiv.className = 'flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50';
                    applicantDiv.innerHTML = `
                        <div class="flex-shrink-0">
                            <div class="bg-gray-200 rounded-full w-12 h-12 flex items-center justify-center">
                                <i class="fas fa-user text-gray-500"></i>
                            </div>
                        </div>
                        <div class="ml-4 flex-1">
                            <h3 class="font-medium text-gray-900">${applicant.name}</h3>
                            <p class="text-sm text-gray-500">Applied for ${applicant.jobTitle}</p>
                            <div class="mt-1 flex items-center">
                                <i class="fas fa-map-marker-alt text-xs text-gray-400 mr-1"></i>
                                <span class="text-xs text-gray-500">${applicant.location}</span>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 text-xs font-medium rounded-full ${getApplicantStatusClass(applicant.status)}">
                                ${applicant.status}
                            </span>
                            <a href="applicant-detail.html?id=${applicant.id}" class="text-orange-500 hover:text-orange-600">
                                <i class="fas fa-ellipsis-v"></i>
                            </a>
                        </div>
                    `;
                    applicantsList.appendChild(applicantDiv);
                });
                recentApplicantsDiv.style.display = 'block';
            })
            .catch(error => {
                console.error('Error loading dashboard:', error);
                loadingDiv.innerHTML = `
                    <p class="text-red-500">Error loading dashboard data. Please try again later.</p>
                `;
            });

            function formatDate(dateString) {
                const date = new Date(dateString);
                const diff = Math.floor((new Date() - date) / (1000 * 60 * 60 * 24));
                return diff === 0 ? 'Today' : `${diff} day${diff !== 1 ? 's' : ''} ago`;
            }

            function getStatusClass(status) {
                switch(status.toLowerCase()) {
                    case 'active': return 'bg-orange-100 text-orange-800';
                    case 'filled': return 'bg-gray-100 text-gray-800';
                    case 'closed': return 'bg-red-100 text-red-800';
                    default: return 'bg-gray-100 text-gray-800';
                }
            }

            function getApplicantStatusClass(status) {
                switch(status.toLowerCase()) {
                    case 'new': return 'bg-blue-100 text-blue-800';
                    case 'pending': return 'bg-yellow-100 text-yellow-800';
                    case 'hired': return 'bg-green-100 text-green-800';
                    case 'rejected': return 'bg-red-100 text-red-800';
                    default: return 'bg-gray-100 text-gray-800';
                }
            }
        });
    </script>
    <!-- Footer -->
    <footer class="bg-gray-800 text-white pt-12 pb-6">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4">LabourLinks</h3>
                    <p class="text-gray-400">Connecting Kenyan workers with opportunities since 2023.</p>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="landing.html" class="text-gray-400 hover:text-white">Home</a></li>
                        <li><a href="job.html" class="text-gray-400 hover:text-white">Jobs</a></li>
                        <li><a href="postjob.html" class="text-gray-400 hover:text-white">Post Job</a></li>
                        <li><a href="login,html.html" class="text-gray-400 hover:text-white">Login</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Contact</h4>
                    <ul class="space-y-2">
                        <li class="flex items-center text-gray-400"><i class="fas fa-phone-alt mr-2"></i> +254 700 123456</li>
                        <li class="flex items-center text-gray-400"><i class="fas fa-envelope mr-2"></i> info@labourlinks.co.ke</li>
                        <li class="flex items-center text-gray-400"><i class="fas fa-map-marker-alt mr-2"></i> Nairobi, Kenya</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Follow Us</h4>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-400">
                <p>&copy; 2025 LabourLinks Kenya. All rights reserved.</p>
            </div>
        </div>
    </footer>
</body>
</html>